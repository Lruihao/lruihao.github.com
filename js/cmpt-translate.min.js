(()=>{var g=!1,u=[],d=[],h=["title"],p=["chinese_simplified","chinese_traditional"],f="client.edge";var c=class{constructor(){this.ignoreClass=["header-title","language-switch","post-author","powered","author","typeit","katex-display","repo-url","netease-music","comment-163",...u],this.isMobile=fixit.util.isMobile(),this.afterTranslateEvents=new Set,this.language={current:translate.language.getCurrent(),local:translate.language.getLocal(),query:window.location.search.split("lang=")[1]}}bindDesktopEvents(){let a=document.querySelector("#header-desktop .language-switch.auto");if(!a)return;let n=a.querySelector(".sub-menu"),e=Array.from(n.childNodes).filter(s=>s.dataset.type==="artificial");fixit.util.forEach(e,s=>{s.addEventListener("click",o=>{translate.language.clearCacheLanguage()})});let t=Array.from(n.childNodes).filter(s=>s.dataset.type==="machine");fixit.util.forEach(t,s=>{s.addEventListener("click",o=>{let r=s.children[0].dataset.lang;window.history.pushState({},"",`?lang=${r}`),t.forEach(l=>{l.classList.remove("active")}),s.classList.add("active"),translate.changeLanguage(r)})}),a.previousElementSibling.classList.add("d-none"),a.classList.remove("d-none")}bindMobileEvents(){let a=document.querySelector("#header-mobile .language-switch.auto");if(!a)return;translate.selectLanguageTag.selectOnChange=e=>{let t=e.target.value;e.target.options[e.target.selectedIndex].dataset.type==="artificial"?(translate.language.clearCacheLanguage(),window.location=t):(window.history.pushState({},"",`?lang=${t}`),translate.changeLanguage(t))};let n=a.previousElementSibling;a.prepend(n.querySelector("span").cloneNode(!0)),this.afterTranslateEvents.add(()=>{let e=a.querySelector("select");e.classList.add("language-select"),fixit.util.forEach(e.querySelectorAll("option"),l=>{l.dataset.type="machine"});let t=document.createElement("option");t.disabled=!0,t.innerHTML="-",e.prepend(t),fixit.util.forEach(n.querySelectorAll("option"),l=>{l.dataset.type="artificial"}),e.prepend(...n.querySelectorAll("option:not([selected])")),e.prepend(n.querySelector("option[selected]"));let{current:s,local:o,query:r}=this.language;(s!==o||r)&&(e.value=s),n.classList.add("d-none"),a.classList.remove("d-none")})}bindEvents(){this.isMobile?this.bindMobileEvents():this.bindDesktopEvents()}setup(){g&&translate.setAutoDiscriminateLocalLanguage();let{current:a,local:n,query:e}=this.language;(a!==n||e)&&fixit.util.forEach(document.querySelectorAll(`.menu-link[data-lang="${a}"]`),t=>{t.parentElement.classList.add("active")}),translate.ignore.id.push(...d),translate.ignore.class.push(...this.ignoreClass),translate.ignore.tag.push(...h),translate.service.use(f),translate.language.setUrlParamControl("lang"),translate.listener.start(),translate.selectLanguageTag.show=this.isMobile,translate.selectLanguageTag.languages=p.join(","),translate.execute(),this.afterTranslateEvents.forEach(t=>{t()})}init(){this.bindEvents(),this.setup()}},m=new c;document.readyState!=="loading"?m.init():document.addEventListener("DOMContentLoaded",()=>m.init(),!1);})();
