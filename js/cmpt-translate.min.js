(()=>{var g=!1,u=[],d=[],h=["title"],p=["chinese_traditional"],f="client.edge";var m=["header-title","language-switch","post-author","powered","author","typeit","katex-display"],v=["repo-url","netease-music","comment-163"],c=class{constructor(){this.service=f,this.languages=p,this.ignoreClass=[...m,...v,...u],this.ignoreID=d,this.ignoreTag=h,this.detectLocalLanguage=g,this.isMobile=fixit.util.isMobile(),this.afterTranslateEvents=new Set,this.lang={current:translate.language.getCurrent(),local:window.pageLang||translate.language.getLocal(),query:window.location.search.split("lang=")[1]}}bindDesktopEvents(){let e=document.querySelector("#header-desktop .language-switch.auto");if(!e)return;let s=e.querySelector(".sub-menu"),t=Array.from(s.childNodes).filter(n=>n.dataset.type==="artificial");fixit.util.forEach(t,n=>{n.addEventListener("click",o=>{translate.language.clearCacheLanguage()})});let a=Array.from(s.childNodes).filter(n=>n.dataset.type==="machine");fixit.util.forEach(a,n=>{n.addEventListener("click",o=>{let i=n.children[0].dataset.lang;window.history.pushState({},"",`?lang=${i}`),a.forEach(L=>{L.classList.remove("active")}),n.classList.add("active"),translate.changeLanguage(i)})});let r=e.previousElementSibling;r.classList.contains("language-switch")&&r.classList.add("d-none"),e.classList.remove("d-none")}bindMobileEvents(){let e=document.querySelector("#header-mobile .language-switch.auto");if(!e)return;translate.selectLanguageTag.selectOnChange=t=>{let a=t.target.value;t.target.options[t.target.selectedIndex].dataset.type==="artificial"?(translate.language.clearCacheLanguage(),window.location=a):(window.history.pushState({},"",`?lang=${a}`),translate.changeLanguage(a))};let s=e.previousElementSibling;e.prepend(s.querySelector("span").cloneNode(!0)),this.afterTranslateEvents.add(()=>{let t=e.querySelector("select");t.classList.add("language-select"),fixit.util.forEach(t.querySelectorAll("option"),i=>{i.dataset.type="machine"});let a=document.createElement("option");a.disabled=!0,a.innerHTML="-",t.prepend(a),fixit.util.forEach(s.querySelectorAll("option"),i=>{i.dataset.type="artificial"}),t.prepend(...s.querySelectorAll("option:not([selected])")),t.prepend(s.querySelector("option[selected]"));let{current:r,local:n,query:o}=this.lang;(r!==n||o)&&(t.value=r),s.classList.add("d-none"),e.classList.remove("d-none")})}bindEvents(){return this.isMobile?this.bindMobileEvents():this.bindDesktopEvents(),this}setup(){this.detectLocalLanguage&&translate.setAutoDiscriminateLocalLanguage();let{current:e,local:s,query:t}=this.lang;return(e!==s||t)&&fixit.util.forEach(document.querySelectorAll(`.menu-link[data-lang="${e}"]`),a=>{a.parentElement.classList.add("active")}),translate.ignore.id.push(...this.ignoreID),translate.ignore.class.push(...this.ignoreClass),translate.ignore.tag.push(...this.ignoreTag),translate.service.use(this.service),translate.language.setLocal(this.lang.local),translate.language.setUrlParamControl("lang"),translate.listener.start(),translate.selectLanguageTag.show=this.isMobile,translate.selectLanguageTag.languages=this.languages.join(","),this}execute(){translate.execute(),this.afterTranslateEvents.forEach(e=>{e()})}selectionTranslate(e="chinese_simplified"){translate.language.setDefaultTo(e),translate.selectionTranslate.start()}init(){this.setup().bindEvents().execute()}};fixit.autoTranslate=new c;document.readyState!=="loading"?fixit.autoTranslate.init():document.addEventListener("DOMContentLoaded",()=>fixit.autoTranslate.init(),!1);})();
